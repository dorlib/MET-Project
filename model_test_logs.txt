Attaching to met-project_model-service_1
[36mmodel-service_1             |[0m [2025-06-29 09:50:12 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 09:50:12 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 09:50:12 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 09:50:12 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 09:50:20 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 09:50:20 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 0 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model on startup: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m [2025-06-29 09:50:29 +0000] [14] [INFO] Application startup complete.
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/40b8d0ac-aad9-4290-8e0f-f4a461dca6bb.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/40b8d0ac-aad9-4290-8e0f-f4a461dca6bb_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/40b8d0ac-aad9-4290-8e0f-f4a461dca6bb_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/40b8d0ac-aad9-4290-8e0f-f4a461dca6bb_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/40b8d0ac-aad9-4290-8e0f-f4a461dca6bb.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb
[36mmodel-service_1             |[0m INFO:app.main:Job 40b8d0ac-aad9-4290-8e0f-f4a461dca6bb completed successfully
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [14] [INFO] Shutting down
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [14] [INFO] Error while closing socket [Errno 9] Bad file descriptor
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [14] [INFO] Waiting for application shutdown.
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [14] [INFO] Application shutdown complete.
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [14] [INFO] Finished server process [14]
[36mmodel-service_1             |[0m [2025-06-29 10:00:12 +0000] [14] [INFO] Worker exiting (pid: 14)
[36mmodel-service_1             |[0m [2025-06-29 10:00:13 +0000] [1] [INFO] Shutting down: Master
[36mmodel-service_1             |[0m [2025-06-29 10:00:15 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 10:00:15 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 10:00:15 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 10:00:15 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 10:00:23 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 10:00:23 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 1 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model on startup: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m [2025-06-29 10:00:32 +0000] [14] [INFO] Application startup complete.
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/92de28c8-6837-4b4d-b052-aaffbea1e223.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 92de28c8-6837-4b4d-b052-aaffbea1e223 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: 92de28c8-6837-4b4d-b052-aaffbea1e223
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 92de28c8-6837-4b4d-b052-aaffbea1e223
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/92de28c8-6837-4b4d-b052-aaffbea1e223_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job 92de28c8-6837-4b4d-b052-aaffbea1e223
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/92de28c8-6837-4b4d-b052-aaffbea1e223_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/92de28c8-6837-4b4d-b052-aaffbea1e223_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/92de28c8-6837-4b4d-b052-aaffbea1e223.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 92de28c8-6837-4b4d-b052-aaffbea1e223 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: 92de28c8-6837-4b4d-b052-aaffbea1e223
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 92de28c8-6837-4b4d-b052-aaffbea1e223
[36mmodel-service_1             |[0m INFO:app.main:Job 92de28c8-6837-4b4d-b052-aaffbea1e223 completed successfully
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/ac94b699-09f4-4565-8c45-5c894a87fc47.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job ac94b699-09f4-4565-8c45-5c894a87fc47 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: ac94b699-09f4-4565-8c45-5c894a87fc47
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: ac94b699-09f4-4565-8c45-5c894a87fc47
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/ac94b699-09f4-4565-8c45-5c894a87fc47_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job ac94b699-09f4-4565-8c45-5c894a87fc47
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/ac94b699-09f4-4565-8c45-5c894a87fc47_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/ac94b699-09f4-4565-8c45-5c894a87fc47_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/ac94b699-09f4-4565-8c45-5c894a87fc47.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job ac94b699-09f4-4565-8c45-5c894a87fc47 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: ac94b699-09f4-4565-8c45-5c894a87fc47
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: ac94b699-09f4-4565-8c45-5c894a87fc47
[36mmodel-service_1             |[0m INFO:app.main:Job ac94b699-09f4-4565-8c45-5c894a87fc47 completed successfully
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/a2c2a027-0d8f-4a53-849a-579875651095.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job a2c2a027-0d8f-4a53-849a-579875651095 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: a2c2a027-0d8f-4a53-849a-579875651095
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: a2c2a027-0d8f-4a53-849a-579875651095
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/a2c2a027-0d8f-4a53-849a-579875651095_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job a2c2a027-0d8f-4a53-849a-579875651095
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/a2c2a027-0d8f-4a53-849a-579875651095_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/a2c2a027-0d8f-4a53-849a-579875651095_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/a2c2a027-0d8f-4a53-849a-579875651095.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job a2c2a027-0d8f-4a53-849a-579875651095 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: a2c2a027-0d8f-4a53-849a-579875651095
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: a2c2a027-0d8f-4a53-849a-579875651095
[36mmodel-service_1             |[0m INFO:app.main:Job a2c2a027-0d8f-4a53-849a-579875651095 completed successfully
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/8578b49c-3af7-4e24-94b1-a713ef705f47.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 8578b49c-3af7-4e24-94b1-a713ef705f47 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: 8578b49c-3af7-4e24-94b1-a713ef705f47
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 8578b49c-3af7-4e24-94b1-a713ef705f47
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/8578b49c-3af7-4e24-94b1-a713ef705f47_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job 8578b49c-3af7-4e24-94b1-a713ef705f47
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/8578b49c-3af7-4e24-94b1-a713ef705f47_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/8578b49c-3af7-4e24-94b1-a713ef705f47_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/8578b49c-3af7-4e24-94b1-a713ef705f47.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 8578b49c-3af7-4e24-94b1-a713ef705f47 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: 8578b49c-3af7-4e24-94b1-a713ef705f47
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 8578b49c-3af7-4e24-94b1-a713ef705f47
[36mmodel-service_1             |[0m INFO:app.main:Job 8578b49c-3af7-4e24-94b1-a713ef705f47 completed successfully
[36mmodel-service_1             |[0m [2025-06-29 10:12:06 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 10:12:06 +0000] [14] [INFO] Shutting down
[36mmodel-service_1             |[0m [2025-06-29 10:12:06 +0000] [14] [INFO] Error while closing socket [Errno 9] Bad file descriptor
[36mmodel-service_1             |[0m [2025-06-29 10:12:07 +0000] [14] [INFO] Waiting for application shutdown.
[36mmodel-service_1             |[0m [2025-06-29 10:12:07 +0000] [14] [INFO] Application shutdown complete.
[36mmodel-service_1             |[0m [2025-06-29 10:12:07 +0000] [14] [INFO] Finished server process [14]
[36mmodel-service_1             |[0m [2025-06-29 10:12:07 +0000] [14] [INFO] Worker exiting (pid: 14)
[36mmodel-service_1             |[0m [2025-06-29 10:12:08 +0000] [1] [INFO] Shutting down: Master
[36mmodel-service_1             |[0m [2025-06-29 10:12:10 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 10:12:10 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 10:12:10 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 10:12:10 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 10:12:18 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 10:12:18 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 5 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model on startup: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m [2025-06-29 10:12:27 +0000] [14] [INFO] Application startup complete.
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [14] [INFO] Shutting down
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [14] [INFO] Error while closing socket [Errno 9] Bad file descriptor
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [14] [INFO] Waiting for application shutdown.
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [14] [INFO] Application shutdown complete.
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [14] [INFO] Finished server process [14]
[36mmodel-service_1             |[0m [2025-06-29 10:17:15 +0000] [14] [INFO] Worker exiting (pid: 14)
[36mmodel-service_1             |[0m [2025-06-29 10:17:16 +0000] [1] [INFO] Shutting down: Master
[36mmodel-service_1             |[0m [2025-06-29 10:17:18 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 10:17:18 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 10:17:18 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 10:17:18 +0000] [13] [INFO] Booting worker with pid: 13
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 10:17:25 +0000] [13] [INFO] Started server process [13]
[36mmodel-service_1             |[0m [2025-06-29 10:17:25 +0000] [13] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 5 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model on startup: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m [2025-06-29 10:17:34 +0000] [13] [INFO] Application startup complete.
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/de63c4f0-3b78-4e3c-85c0-0e80f9099777.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job de63c4f0-3b78-4e3c-85c0-0e80f9099777 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: de63c4f0-3b78-4e3c-85c0-0e80f9099777
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: de63c4f0-3b78-4e3c-85c0-0e80f9099777
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/de63c4f0-3b78-4e3c-85c0-0e80f9099777_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job de63c4f0-3b78-4e3c-85c0-0e80f9099777
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/de63c4f0-3b78-4e3c-85c0-0e80f9099777_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/de63c4f0-3b78-4e3c-85c0-0e80f9099777_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/de63c4f0-3b78-4e3c-85c0-0e80f9099777.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job de63c4f0-3b78-4e3c-85c0-0e80f9099777 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: de63c4f0-3b78-4e3c-85c0-0e80f9099777
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: de63c4f0-3b78-4e3c-85c0-0e80f9099777
[36mmodel-service_1             |[0m INFO:app.main:Job de63c4f0-3b78-4e3c-85c0-0e80f9099777 completed successfully
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [13] [INFO] Shutting down
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [13] [INFO] Error while closing socket [Errno 9] Bad file descriptor
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [13] [INFO] Waiting for application shutdown.
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [13] [INFO] Application shutdown complete.
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [13] [INFO] Finished server process [13]
[36mmodel-service_1             |[0m [2025-06-29 10:26:56 +0000] [13] [INFO] Worker exiting (pid: 13)
[36mmodel-service_1             |[0m [2025-06-29 10:26:58 +0000] [1] [INFO] Shutting down: Master
[36mmodel-service_1             |[0m [2025-06-29 10:26:59 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 10:26:59 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 10:26:59 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 10:26:59 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 10:27:07 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 10:27:07 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 6 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model on startup: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m [2025-06-29 10:27:16 +0000] [14] [INFO] Application startup complete.
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/d5f9974f-df4c-442e-8829-b4cb9c11ea28.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job d5f9974f-df4c-442e-8829-b4cb9c11ea28 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: d5f9974f-df4c-442e-8829-b4cb9c11ea28
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: d5f9974f-df4c-442e-8829-b4cb9c11ea28
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/d5f9974f-df4c-442e-8829-b4cb9c11ea28_image_82_00182.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Model not loaded yet, loading now...
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m WARNING:app.main:Using dummy prediction due to model loading failure
[36mmodel-service_1             |[0m WARNING:app.main:Creating dummy segmentation for job d5f9974f-df4c-442e-8829-b4cb9c11ea28
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/d5f9974f-df4c-442e-8829-b4cb9c11ea28_prediction.npy with shape (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Saved prediction to /app/results/d5f9974f-df4c-442e-8829-b4cb9c11ea28_prediction.npy
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/d5f9974f-df4c-442e-8829-b4cb9c11ea28.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job d5f9974f-df4c-442e-8829-b4cb9c11ea28 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: d5f9974f-df4c-442e-8829-b4cb9c11ea28
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: d5f9974f-df4c-442e-8829-b4cb9c11ea28
[36mmodel-service_1             |[0m INFO:app.main:Job d5f9974f-df4c-442e-8829-b4cb9c11ea28 completed successfully
[36mmodel-service_1             |[0m [2025-06-29 11:17:07 +0000] [1] [CRITICAL] WORKER TIMEOUT (pid:14)
[36mmodel-service_1             |[0m qemu: uncaught target signal 6 (Aborted) - core dumped
[36mmodel-service_1             |[0m [2025-06-29 11:17:08 +0000] [1] [WARNING] Worker with pid 14 was terminated due to signal 6
[36mmodel-service_1             |[0m [2025-06-29 11:17:08 +0000] [45] [INFO] Booting worker with pid: 45
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 11:17:16 +0000] [45] [INFO] Started server process [45]
[36mmodel-service_1             |[0m [2025-06-29 11:17:16 +0000] [45] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 7 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m ERROR:app.model:Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m ERROR:app.main:Failed to load model on startup: Failed to load model: Error(s) in loading state_dict for UNETR:
[36mmodel-service_1             |[0m 	Missing key(s) in state_dict: "vit.patch_embedding.position_embeddings", "vit.patch_embedding.patch_embeddings.1.weight", "vit.patch_embedding.patch_embeddings.1.bias", "vit.blocks.0.mlp.linear1.weight", "vit.blocks.0.mlp.linear1.bias", "vit.blocks.0.mlp.linear2.weight", "vit.blocks.0.mlp.linear2.bias", "vit.blocks.0.norm1.weight", "vit.blocks.0.norm1.bias", "vit.blocks.0.attn.out_proj.weight", "vit.blocks.0.attn.out_proj.bias", "vit.blocks.0.attn.qkv.weight", "vit.blocks.0.norm2.weight", "vit.blocks.0.norm2.bias", "vit.blocks.1.mlp.linear1.weight", "vit.blocks.1.mlp.linear1.bias", "vit.blocks.1.mlp.linear2.weight", "vit.blocks.1.mlp.linear2.bias", "vit.blocks.1.norm1.weight", "vit.blocks.1.norm1.bias", "vit.blocks.1.attn.out_proj.weight", "vit.blocks.1.attn.out_proj.bias", "vit.blocks.1.attn.qkv.weight", "vit.blocks.1.norm2.weight", "vit.blocks.1.norm2.bias", "vit.blocks.2.mlp.linear1.weight", "vit.blocks.2.mlp.linear1.bias", "vit.blocks.2.mlp.linear2.weight", "vit.blocks.2.mlp.linear2.bias", "vit.blocks.2.norm1.weight", "vit.blocks.2.norm1.bias", "vit.blocks.2.attn.out_proj.weight", "vit.blocks.2.attn.out_proj.bias", "vit.blocks.2.attn.qkv.weight", "vit.blocks.2.norm2.weight", "vit.blocks.2.norm2.bias", "vit.blocks.3.mlp.linear1.weight", "vit.blocks.3.mlp.linear1.bias", "vit.blocks.3.mlp.linear2.weight", "vit.blocks.3.mlp.linear2.bias", "vit.blocks.3.norm1.weight", "vit.blocks.3.norm1.bias", "vit.blocks.3.attn.out_proj.weight", "vit.blocks.3.attn.out_proj.bias", "vit.blocks.3.attn.qkv.weight", "vit.blocks.3.norm2.weight", "vit.blocks.3.norm2.bias", "vit.blocks.4.mlp.linear1.weight", "vit.blocks.4.mlp.linear1.bias", "vit.blocks.4.mlp.linear2.weight", "vit.blocks.4.mlp.linear2.bias", "vit.blocks.4.norm1.weight", "vit.blocks.4.norm1.bias", "vit.blocks.4.attn.out_proj.weight", "vit.blocks.4.attn.out_proj.bias", "vit.blocks.4.attn.qkv.weight", "vit.blocks.4.norm2.weight", "vit.blocks.4.norm2.bias", "vit.blocks.5.mlp.linear1.weight", "vit.blocks.5.mlp.linear1.bias", "vit.blocks.5.mlp.linear2.weight", "vit.blocks.5.mlp.linear2.bias", "vit.blocks.5.norm1.weight", "vit.blocks.5.norm1.bias", "vit.blocks.5.attn.out_proj.weight", "vit.blocks.5.attn.out_proj.bias", "vit.blocks.5.attn.qkv.weight", "vit.blocks.5.norm2.weight", "vit.blocks.5.norm2.bias", "vit.blocks.6.mlp.linear1.weight", "vit.blocks.6.mlp.linear1.bias", "vit.blocks.6.mlp.linear2.weight", "vit.blocks.6.mlp.linear2.bias", "vit.blocks.6.norm1.weight", "vit.blocks.6.norm1.bias", "vit.blocks.6.attn.out_proj.weight", "vit.blocks.6.attn.out_proj.bias", "vit.blocks.6.attn.qkv.weight", "vit.blocks.6.norm2.weight", "vit.blocks.6.norm2.bias", "vit.blocks.7.mlp.linear1.weight", "vit.blocks.7.mlp.linear1.bias", "vit.blocks.7.mlp.linear2.weight", "vit.blocks.7.mlp.linear2.bias", "vit.blocks.7.norm1.weight", "vit.blocks.7.norm1.bias", "vit.blocks.7.attn.out_proj.weight", "vit.blocks.7.attn.out_proj.bias", "vit.blocks.7.attn.qkv.weight", "vit.blocks.7.norm2.weight", "vit.blocks.7.norm2.bias", "vit.blocks.8.mlp.linear1.weight", "vit.blocks.8.mlp.linear1.bias", "vit.blocks.8.mlp.linear2.weight", "vit.blocks.8.mlp.linear2.bias", "vit.blocks.8.norm1.weight", "vit.blocks.8.norm1.bias", "vit.blocks.8.attn.out_proj.weight", "vit.blocks.8.attn.out_proj.bias", "vit.blocks.8.attn.qkv.weight", "vit.blocks.8.norm2.weight", "vit.blocks.8.norm2.bias", "vit.blocks.9.mlp.linear1.weight", "vit.blocks.9.mlp.linear1.bias", "vit.blocks.9.mlp.linear2.weight", "vit.blocks.9.mlp.linear2.bias", "vit.blocks.9.norm1.weight", "vit.blocks.9.norm1.bias", "vit.blocks.9.attn.out_proj.weight", "vit.blocks.9.attn.out_proj.bias", "vit.blocks.9.attn.qkv.weight", "vit.blocks.9.norm2.weight", "vit.blocks.9.norm2.bias", "vit.blocks.10.mlp.linear1.weight", "vit.blocks.10.mlp.linear1.bias", "vit.blocks.10.mlp.linear2.weight", "vit.blocks.10.mlp.linear2.bias", "vit.blocks.10.norm1.weight", "vit.blocks.10.norm1.bias", "vit.blocks.10.attn.out_proj.weight", "vit.blocks.10.attn.out_proj.bias", "vit.blocks.10.attn.qkv.weight", "vit.blocks.10.norm2.weight", "vit.blocks.10.norm2.bias", "vit.blocks.11.mlp.linear1.weight", "vit.blocks.11.mlp.linear1.bias", "vit.blocks.11.mlp.linear2.weight", "vit.blocks.11.mlp.linear2.bias", "vit.blocks.11.norm1.weight", "vit.blocks.11.norm1.bias", "vit.blocks.11.attn.out_proj.weight", "vit.blocks.11.attn.out_proj.bias", "vit.blocks.11.attn.qkv.weight", "vit.blocks.11.norm2.weight", "vit.blocks.11.norm2.bias", "vit.norm.weight", "vit.norm.bias", "encoder1.layer.conv1.conv.weight", "encoder1.layer.conv2.conv.weight", "encoder1.layer.conv3.conv.weight", "encoder2.transp_conv_init.conv.weight", "encoder2.blocks.0.0.conv.weight", "encoder2.blocks.0.1.conv1.conv.weight", "encoder2.blocks.0.1.conv2.conv.weight", "encoder2.blocks.1.0.conv.weight", "encoder2.blocks.1.1.conv1.conv.weight", "encoder2.blocks.1.1.conv2.conv.weight", "encoder3.transp_conv_init.conv.weight", "encoder3.blocks.0.0.conv.weight", "encoder3.blocks.0.1.conv1.conv.weight", "encoder3.blocks.0.1.conv2.conv.weight", "encoder4.transp_conv_init.conv.weight", "decoder5.transp_conv.conv.weight", "decoder5.conv_block.conv1.conv.weight", "decoder5.conv_block.conv2.conv.weight", "decoder5.conv_block.conv3.conv.weight", "decoder4.transp_conv.conv.weight", "decoder4.conv_block.conv1.conv.weight", "decoder4.conv_block.conv2.conv.weight", "decoder4.conv_block.conv3.conv.weight", "decoder3.transp_conv.conv.weight", "decoder3.conv_block.conv1.conv.weight", "decoder3.conv_block.conv2.conv.weight", "decoder3.conv_block.conv3.conv.weight", "decoder2.transp_conv.conv.weight", "decoder2.conv_block.conv1.conv.weight", "decoder2.conv_block.conv2.conv.weight", "decoder2.conv_block.conv3.conv.weight", "out.conv.conv.weight", "out.conv.conv.bias". 
[36mmodel-service_1             |[0m 	Unexpected key(s) in state_dict: "embed.patch_embeddings.weight", "embed.position_embeddings.abs_pos_enc", "transformer.block_list.0.mhsa.to_qvk.weight", "transformer.block_list.0.mhsa.W_0.weight", "transformer.block_list.0.norm_1.weight", "transformer.block_list.0.norm_1.bias", "transformer.block_list.0.norm_2.weight", "transformer.block_list.0.norm_2.bias", "transformer.block_list.0.linear.0.weight", "transformer.block_list.0.linear.0.bias", "transformer.block_list.0.linear.3.weight", "transformer.block_list.0.linear.3.bias", "transformer.block_list.1.mhsa.to_qvk.weight", "transformer.block_list.1.mhsa.W_0.weight", "transformer.block_list.1.norm_1.weight", "transformer.block_list.1.norm_1.bias", "transformer.block_list.1.norm_2.weight", "transformer.block_list.1.norm_2.bias", "transformer.block_list.1.linear.0.weight", "transformer.block_list.1.linear.0.bias", "transformer.block_list.1.linear.3.weight", "transformer.block_list.1.linear.3.bias", "transformer.block_list.2.mhsa.to_qvk.weight", "transformer.block_list.2.mhsa.W_0.weight", "transformer.block_list.2.norm_1.weight", "transformer.block_list.2.norm_1.bias", "transformer.block_list.2.norm_2.weight", "transformer.block_list.2.norm_2.bias", "transformer.block_list.2.linear.0.weight", "transformer.block_list.2.linear.0.bias", "transformer.block_list.2.linear.3.weight", "transformer.block_list.2.linear.3.bias", "transformer.block_list.3.mhsa.to_qvk.weight", "transformer.block_list.3.mhsa.W_0.weight", "transformer.block_list.3.norm_1.weight", "transformer.block_list.3.norm_1.bias", "transformer.block_list.3.norm_2.weight", "transformer.block_list.3.norm_2.bias", "transformer.block_list.3.linear.0.weight", "transformer.block_list.3.linear.0.bias", "transformer.block_list.3.linear.3.weight", "transformer.block_list.3.linear.3.bias", "transformer.block_list.4.mhsa.to_qvk.weight", "transformer.block_list.4.mhsa.W_0.weight", "transformer.block_list.4.norm_1.weight", "transformer.block_list.4.norm_1.bias", "transformer.block_list.4.norm_2.weight", "transformer.block_list.4.norm_2.bias", "transformer.block_list.4.linear.0.weight", "transformer.block_list.4.linear.0.bias", "transformer.block_list.4.linear.3.weight", "transformer.block_list.4.linear.3.bias", "transformer.block_list.5.mhsa.to_qvk.weight", "transformer.block_list.5.mhsa.W_0.weight", "transformer.block_list.5.norm_1.weight", "transformer.block_list.5.norm_1.bias", "transformer.block_list.5.norm_2.weight", "transformer.block_list.5.norm_2.bias", "transformer.block_list.5.linear.0.weight", "transformer.block_list.5.linear.0.bias", "transformer.block_list.5.linear.3.weight", "transformer.block_list.5.linear.3.bias", "transformer.block_list.6.mhsa.to_qvk.weight", "transformer.block_list.6.mhsa.W_0.weight", "transformer.block_list.6.norm_1.weight", "transformer.block_list.6.norm_1.bias", "transformer.block_list.6.norm_2.weight", "transformer.block_list.6.norm_2.bias", "transformer.block_list.6.linear.0.weight", "transformer.block_list.6.linear.0.bias", "transformer.block_list.6.linear.3.weight", "transformer.block_list.6.linear.3.bias", "transformer.block_list.7.mhsa.to_qvk.weight", "transformer.block_list.7.mhsa.W_0.weight", "transformer.block_list.7.norm_1.weight", "transformer.block_list.7.norm_1.bias", "transformer.block_list.7.norm_2.weight", "transformer.block_list.7.norm_2.bias", "transformer.block_list.7.linear.0.weight", "transformer.block_list.7.linear.0.bias", "transformer.block_list.7.linear.3.weight", "transformer.block_list.7.linear.3.bias", "transformer.block_list.8.mhsa.to_qvk.weight", "transformer.block_list.8.mhsa.W_0.weight", "transformer.block_list.8.norm_1.weight", "transformer.block_list.8.norm_1.bias", "transformer.block_list.8.norm_2.weight", "transformer.block_list.8.norm_2.bias", "transformer.block_list.8.linear.0.weight", "transformer.block_list.8.linear.0.bias", "transformer.block_list.8.linear.3.weight", "transformer.block_list.8.linear.3.bias", "transformer.block_list.9.mhsa.to_qvk.weight", "transformer.block_list.9.mhsa.W_0.weight", "transformer.block_list.9.norm_1.weight", "transformer.block_list.9.norm_1.bias", "transformer.block_list.9.norm_2.weight", "transformer.block_list.9.norm_2.bias", "transformer.block_list.9.linear.0.weight", "transformer.block_list.9.linear.0.bias", "transformer.block_list.9.linear.3.weight", "transformer.block_list.9.linear.3.bias", "transformer.block_list.10.mhsa.to_qvk.weight", "transformer.block_list.10.mhsa.W_0.weight", "transformer.block_list.10.norm_1.weight", "transformer.block_list.10.norm_1.bias", "transformer.block_list.10.norm_2.weight", "transformer.block_list.10.norm_2.bias", "transformer.block_list.10.linear.0.weight", "transformer.block_list.10.linear.0.bias", "transformer.block_list.10.linear.3.weight", "transformer.block_list.10.linear.3.bias", "transformer.block_list.11.mhsa.to_qvk.weight", "transformer.block_list.11.mhsa.W_0.weight", "transformer.block_list.11.norm_1.weight", "transformer.block_list.11.norm_1.bias", "transformer.block_list.11.norm_2.weight", "transformer.block_list.11.norm_2.bias", "transformer.block_list.11.linear.0.weight", "transformer.block_list.11.linear.0.bias", "transformer.block_list.11.linear.3.weight", "transformer.block_list.11.linear.3.bias", "init_conv.conv_block.0.weight", "init_conv.conv_block.0.bias", "init_conv.conv_block.3.weight", "init_conv.conv_block.3.bias", "init_conv.conv_down.0.weight", "init_conv.conv_down.0.bias", "z3_blue_conv.blocks.0.block.weight", "z3_blue_conv.blocks.1.block.weight", "z3_blue_conv.blocks.2.block.weight", "z6_blue_conv.blocks.0.block.weight", "z6_blue_conv.blocks.1.block.weight", "z9_blue_conv.blocks.0.block.weight", "z12_deconv.block.weight", "z9_deconv.block.weight", "z6_deconv.block.weight", "z3_deconv.block.weight", "z9_conv.conv_block.0.weight", "z9_conv.conv_block.0.bias", "z9_conv.conv_block.3.weight", "z9_conv.conv_block.3.bias", "z9_conv.conv_down.0.weight", "z9_conv.conv_down.0.bias", "z6_conv.conv_block.0.weight", "z6_conv.conv_block.0.bias", "z6_conv.conv_block.3.weight", "z6_conv.conv_block.3.bias", "z6_conv.conv_down.0.weight", "z6_conv.conv_down.0.bias", "z3_conv.conv_block.0.weight", "z3_conv.conv_block.0.bias", "z3_conv.conv_block.3.weight", "z3_conv.conv_block.3.bias", "z3_conv.conv_down.0.weight", "z3_conv.conv_down.0.bias", "out_conv.0.conv_block.0.weight", "out_conv.0.conv_block.0.bias", "out_conv.0.conv_block.3.weight", "out_conv.0.conv_block.3.bias", "out_conv.0.conv_down.0.weight", "out_conv.0.conv_down.0.bias", "out_conv.1.weight", "out_conv.1.bias". 
[36mmodel-service_1             |[0m [2025-06-29 11:17:25 +0000] [45] [INFO] Application startup complete.
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [45] [INFO] Shutting down
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [45] [INFO] Error while closing socket [Errno 9] Bad file descriptor
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [45] [INFO] Waiting for application shutdown.
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [45] [INFO] Application shutdown complete.
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [45] [INFO] Finished server process [45]
[36mmodel-service_1             |[0m [2025-06-29 11:36:26 +0000] [45] [INFO] Worker exiting (pid: 45)
[36mmodel-service_1             |[0m [2025-06-29 11:36:28 +0000] [1] [INFO] Shutting down: Master
[36mmodel-service_1             |[0m [2025-06-29 11:36:31 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 11:36:31 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 11:36:31 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 11:36:31 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 11:36:39 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 11:36:39 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 7 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Sample missing keys: ['vit.patch_embedding.position_embeddings', 'vit.patch_embedding.patch_embeddings.1.weight', 'vit.patch_embedding.patch_embeddings.1.bias', 'vit.blocks.0.mlp.linear1.weight', 'vit.blocks.0.mlp.linear1.bias']
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m WARNING:app.model:Sample unexpected keys: ['embed.patch_embeddings.weight', 'embed.position_embeddings.abs_pos_enc', 'transformer.block_list.0.mhsa.to_qvk.weight', 'transformer.block_list.0.mhsa.W_0.weight', 'transformer.block_list.0.norm_1.weight']
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully with strict=False
[36mmodel-service_1             |[0m INFO:app.model:Model set to evaluation mode
[36mmodel-service_1             |[0m INFO:app.main:Model loaded successfully on startup
[36mmodel-service_1             |[0m [2025-06-29 11:36:48 +0000] [14] [INFO] Application startup complete.
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/451db71b-5c84-4507-bbd1-32b4719d55fb.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 451db71b-5c84-4507-bbd1-32b4719d55fb to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: 451db71b-5c84-4507-bbd1-32b4719d55fb
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 451db71b-5c84-4507-bbd1-32b4719d55fb
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/451db71b-5c84-4507-bbd1-32b4719d55fb_image_7_00009.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Running inference for job 451db71b-5c84-4507-bbd1-32b4719d55fb
[36mmodel-service_1             |[0m ERROR:app.main:Error during model inference: Expected 5 dimensions, got 6
[36mmodel-service_1             |[0m ERROR:app.main:Error processing job 451db71b-5c84-4507-bbd1-32b4719d55fb: Model inference failed: Expected 5 dimensions, got 6
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/451db71b-5c84-4507-bbd1-32b4719d55fb.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 451db71b-5c84-4507-bbd1-32b4719d55fb to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: 451db71b-5c84-4507-bbd1-32b4719d55fb
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 451db71b-5c84-4507-bbd1-32b4719d55fb
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/94b32ff2-51b0-42eb-a6a4-d9d717f59351.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 94b32ff2-51b0-42eb-a6a4-d9d717f59351 to database
[36mmodel-service_1             |[0m INFO:app.main:Creating new job in database: 94b32ff2-51b0-42eb-a6a4-d9d717f59351
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 94b32ff2-51b0-42eb-a6a4-d9d717f59351
[36mmodel-service_1             |[0m INFO:app.main:Loading scan from /app/uploads/94b32ff2-51b0-42eb-a6a4-d9d717f59351_image_19_00023.npy
[36mmodel-service_1             |[0m INFO:app.main:Scan shape: (128, 128, 128, 3)
[36mmodel-service_1             |[0m INFO:app.main:Running inference for job 94b32ff2-51b0-42eb-a6a4-d9d717f59351
[36mmodel-service_1             |[0m ERROR:app.main:Error during model inference: Expected 5 dimensions, got 6
[36mmodel-service_1             |[0m ERROR:app.main:Error processing job 94b32ff2-51b0-42eb-a6a4-d9d717f59351: Model inference failed: Expected 5 dimensions, got 6
[36mmodel-service_1             |[0m INFO:app.main:Saved job status to /app/results/job_status/94b32ff2-51b0-42eb-a6a4-d9d717f59351.json
[36mmodel-service_1             |[0m INFO:app.main:Attempting to save job 94b32ff2-51b0-42eb-a6a4-d9d717f59351 to database
[36mmodel-service_1             |[0m INFO:app.main:Updating existing job in database: 94b32ff2-51b0-42eb-a6a4-d9d717f59351
[36mmodel-service_1             |[0m INFO:app.main:Successfully saved job status to database: 94b32ff2-51b0-42eb-a6a4-d9d717f59351
[36mmodel-service_1             |[0m [2025-06-29 12:10:58 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 12:10:58 +0000] [14] [INFO] Shutting down
[36mmodel-service_1             |[0m [2025-06-29 12:10:58 +0000] [14] [INFO] Error while closing socket [Errno 9] Bad file descriptor
[36mmodel-service_1             |[0m [2025-06-29 12:10:59 +0000] [14] [INFO] Waiting for application shutdown.
[36mmodel-service_1             |[0m [2025-06-29 12:10:59 +0000] [14] [INFO] Application shutdown complete.
[36mmodel-service_1             |[0m [2025-06-29 12:10:59 +0000] [14] [INFO] Finished server process [14]
[36mmodel-service_1             |[0m [2025-06-29 12:10:59 +0000] [14] [INFO] Worker exiting (pid: 14)
[36mmodel-service_1             |[0m [2025-06-29 12:11:00 +0000] [1] [INFO] Shutting down: Master
[36mmodel-service_1             |[0m [2025-06-29 12:11:02 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 12:11:02 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 12:11:02 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 12:11:02 +0000] [13] [INFO] Booting worker with pid: 13
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 12:11:10 +0000] [13] [INFO] Started server process [13]
[36mmodel-service_1             |[0m [2025-06-29 12:11:10 +0000] [13] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 9 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully
[36mmodel-service_1             |[0m INFO:app.model:Testing model with dummy input
[36mmodel-service_1             |[0m [2025-06-29 12:16:19 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 12:16:31 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 12:16:31 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 12:16:31 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 12:16:31 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 12:16:39 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 12:16:39 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 9 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m [2025-06-29 12:16:41 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully
[36mmodel-service_1             |[0m INFO:app.model:Testing model with dummy input
[36mmodel-service_1             |[0m [2025-06-29 12:16:53 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 12:16:53 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 12:16:53 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 12:16:53 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 12:17:00 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 12:17:00 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 9 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully
[36mmodel-service_1             |[0m INFO:app.model:Testing model with dummy input
[36mmodel-service_1             |[0m [2025-06-29 12:19:53 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 12:20:05 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 12:20:05 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 12:20:05 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 12:20:05 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 12:20:13 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 12:20:13 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 9 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully
[36mmodel-service_1             |[0m INFO:app.model:Testing model with dummy input
[36mmodel-service_1             |[0m [2025-06-29 12:20:28 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 12:20:40 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 12:20:40 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 12:20:40 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 12:20:40 +0000] [14] [INFO] Booting worker with pid: 14
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 12:20:47 +0000] [14] [INFO] Started server process [14]
[36mmodel-service_1             |[0m [2025-06-29 12:20:47 +0000] [14] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 9 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully
[36mmodel-service_1             |[0m INFO:app.model:Testing model with dummy input
[36mmodel-service_1             |[0m [2025-06-29 12:23:17 +0000] [1] [INFO] Handling signal: term
[36mmodel-service_1             |[0m [2025-06-29 12:23:29 +0000] [1] [INFO] Starting gunicorn 20.1.0
[36mmodel-service_1             |[0m [2025-06-29 12:23:29 +0000] [1] [INFO] Listening at: http://0.0.0.0:5001 (1)
[36mmodel-service_1             |[0m [2025-06-29 12:23:29 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
[36mmodel-service_1             |[0m [2025-06-29 12:23:29 +0000] [13] [INFO] Booting worker with pid: 13
[36mmodel-service_1             |[0m INFO:app.database:Database connecting to: mysql:3306/met_user_service
[36mmodel-service_1             |[0m [2025-06-29 12:23:37 +0000] [13] [INFO] Started server process [13]
[36mmodel-service_1             |[0m [2025-06-29 12:23:37 +0000] [13] [INFO] Waiting for application startup.
[36mmodel-service_1             |[0m INFO:app.main:Starting MET Segmentation Service on cpu
[36mmodel-service_1             |[0m INFO:app.main:Testing database connection and creating tables if needed
[36mmodel-service_1             |[0m INFO:app.main:Database connection successful. Found 9 existing job records.
[36mmodel-service_1             |[0m INFO:app.model:Loading model from /app/models/brats_t1ce.pth on cpu
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict from /app/models/brats_t1ce.pth
[36mmodel-service_1             |[0m INFO:app.model:Loaded state type: <class 'collections.OrderedDict'>
[36mmodel-service_1             |[0m INFO:app.model:Loading state dict with strict=False
[36mmodel-service_1             |[0m WARNING:app.model:Missing keys: 170
[36mmodel-service_1             |[0m WARNING:app.model:Unexpected keys: 164
[36mmodel-service_1             |[0m INFO:app.model:Model loaded successfully
[36mmodel-service_1             |[0m INFO:app.model:Testing model with dummy input
